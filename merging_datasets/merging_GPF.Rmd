---
title: "Merging the GPF Datasets"
subtitle: "Strengthening the Dairy Value Chain"
author: "Julia Silge"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: leonids
---

```{r, echo = FALSE, warning = FALSE}
library(knitr)
knitr::opts_chunk$set(cache = TRUE, warning = FALSE, message = FALSE, dpi = 180)
options(width=80, dplyr.width = 150)
```

There are five rounds of group performance format (GPF) data collected for this project, in July 2014, December 2014, July 2015, December 2015, and August 2016. Let's work on munging, tidying, and merging these five data sets.


## Reading in Round 5

Let's read in the original Excel files for round 5, downloaded from the Google Drive folder.

```{r}
library(readxl)
library(dplyr)
control_round5 <- left_join(read_excel("../data/SDVCII HH Survey_Excel Version_OSS_05092016.xlsx",
                                       sheet = 1),
                            read_excel("../data/SDVCII HH Survey_Excel Version_OSS_05092016.xlsx", 
                                       sheet = 3, col_types = c("numeric", rep("text", 127)))[,1:66], 
                            by = "DEO ID") %>%
    left_join(read_excel("../data/SDVCII HH Survey_Excel Version_OSS_05092016.xlsx", 
                         sheet = 4, col_types = c("numeric", rep("text", 51))),
              by = "DEO ID") %>%
    left_join(read_excel("../data/SDVCII HH Survey_Excel Version_OSS_05092016.xlsx", 
                         sheet = 5, col_types = c("numeric", rep("text", 127))),
              by = "DEO ID")

control_round5_cows <- read_excel("../data/SDVCII HH Survey_Excel Version_OSS_05092016.xlsx",
                                  sheet = 2)
    

treatment_round5 <- left_join(read_excel("../data/3. SDVCII Endline Database_ August 2016_CARE.xlsx",
                                         sheet = 1),
                              read_excel("../data/3. SDVCII Endline Database_ August 2016_CARE.xlsx", 
                                         sheet = 3, col_types = c("numeric", rep("text", 65))), 
                              by = "DEO ID") %>%
    left_join(read_excel("../data/3. SDVCII Endline Database_ August 2016_CARE.xlsx", 
                         sheet = 4, col_types = c("numeric", rep("text", 51))),
              by = "DEO ID") %>%
    left_join(read_excel("../data/3. SDVCII Endline Database_ August 2016_CARE.xlsx", 
                         sheet = 5, col_types = c("numeric", rep("text", 127))),
              by = "DEO ID")

treatment_round5_cows <- read_excel("../data/3. SDVCII Endline Database_ August 2016_CARE.xlsx",
                                    sheet = 2)

```

## Reading in Round 4

```{r}
treatment_round4 <- left_join(read_excel("../data/gpf_round4/Basic Information.xlsx"),
                              read_excel("../data/gpf_round4/Module 2.xlsx"),
                              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 3 Milk Consumption.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 4.xlsx",
                         col_types = c("numeric", rep("text", 53))),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 5 Expenditure.xlsx",
                         col_types = c("numeric", rep("text", 54))),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module  6.xlsx"),
              by = c("DEO SL" = "Deo SL")) %>%
    left_join(read_excel("../data/gpf_round4/Module 7.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 7 Cattle Died Information.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 8.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Modiul 9.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 10.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 11.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 12.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 13 first part.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 13 Last Part.xlsx",
                         col_types = c("numeric", rep("text", 28))),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round4/Module 13 Women Asset Information.xlsx",
                         col_types = c("numeric", rep("text", 13))),
              by = "DEO SL")

treatment_round4_cows <- read_excel("../data/gpf_round4/Module 3 Cattle Information.xlsx")
```


## Reading in Round 3

```{r}
treatment_round3 <- left_join(read_excel("../data/gpf_round3/Module 1.xlsx"),
                              read_excel("../data/gpf_round3/Module 2.xlsx"),
                              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 3 Milk Consumption.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 4 of 4.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 5 Expenditure.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module  6.xlsx"),
              by = c("DEO SL" = "Deo SL")) %>%
    left_join(read_excel("../data/gpf_round3/Module 7.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 7 Cattle Died Information.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Modiul 8.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Modiul 9.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 10.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 11.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 12.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 13 first part.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 13 Last Part.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round3/Module 13 Women Asset Information.xlsx"),
              by = "DEO SL")

treatment_round3_cows <- read_excel("../data/gpf_round3/Module 3 Cattle Information.xlsx")
```

## Reading in Round 2

```{r}
treatment_round2 <- left_join(read_excel("../data/gpf_round2/Module 1.xlsx"),
                              read_excel("../data/gpf_round2/Module 2.xlsx"),
                              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 3 Milk Consumption.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 4.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 5 Expenditure.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 6.xlsx"),
              by = c("DEO SL" = "Deo SL")) %>%
    left_join(read_excel("../data/gpf_round2/Module 7.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 7 Cattle Died Information.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 8.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 9.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 10.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 11.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 12.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 13 first part.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 13 Last Part.xlsx"),
              by = "DEO SL") %>%
    left_join(read_excel("../data/gpf_round2/Module 13 Women Asset Information.xlsx"),
              by = "DEO SL")

treatment_round2_cows <- read_excel("../data/gpf_round2/Module 3 Cattle Information.xlsx")
```

## Reading in Round 1

```{r}
treatment_round1 <- read_excel("../data/SDVC II Baseline.xlsx",
                               sheet = 1,
                               col_types = rep("text", 469))
```

Let's do some date handling while we're here.

```{r}
library(lubridate)
library(stringr)
grep("calvingdate", names(treatment_round1), value = TRUE)

treatment_round1 <- treatment_round1 %>% 
    mutate(Cow1Lastcalvingdate = dmy(Cow1Lastcalvingdate)) %>%
    mutate(Cow2Lastcalvingdate = dmy(Cow2Lastcalvingdate)) %>%
    mutate(Cow3Lastcalvingdate = dmy(Cow3Lastcalvingdate)) %>%
    mutate(Cow4Lastcalvingdate = dmy(Cow4Lastcalvingdate)) %>%
    mutate(Cow5Lastcalvingdate = dmy(Cow5Lastcalvingdate)) %>%
    mutate(Cow6Lastcalvingdate = dmy(Cow6Lastcalvingdate)) %>%
    mutate(Cow7Lastcalvingdate = dmy(Cow7Lastcalvingdate)) %>%
    mutate(Cow8Lastcalvingdate = dmy(Cow8Lastcalvingdate)) %>%
    mutate(Cow9Lastcalvingdate = dmy(Cow9Lastcalvingdate)) %>%
    mutate(Cow10Lastcalvingdate = dmy(Cow10Lastcalvingdate))

```


## Making Names Consistent

Let's keep a copy of the original column names of all of these so we can get them back if necessary.

```{r}
original_names <- bind_rows(
    data_frame(gpf_type = 'treatment', round = 1, names = list(names(treatment_round1))),
    data_frame(gpf_type = 'treatment', round = 2, names = list(names(treatment_round2))),
    data_frame(gpf_type = 'cows', round = 2, names = list(names(treatment_round2_cows))),
    data_frame(gpf_type = 'treatment', round = 3, names = list(names(treatment_round3))),
    data_frame(gpf_type = 'cows', round = 3, names = list(names(treatment_round3_cows))),
    data_frame(gpf_type = 'treatment', round = 4, names = list(names(treatment_round4))),
    data_frame(gpf_type = 'cows', round = 4, names = list(names(treatment_round4_cows))),
    data_frame(gpf_type = 'treatment', round = 5, names = list(names(treatment_round5))),
    data_frame(gpf_type = 'cows', round = 5, names = list(names(treatment_round5_cows))),
    data_frame(gpf_type = 'control', round = 5, names = list(names(control_round5))),
    data_frame(gpf_type = 'controlcows', round = 5, names = list(names(control_round5_cows)))
    )
```

Now let's make these names consistent so we can merge/join this data together.

```{r}
make_names_consistent <- function(df) {
    names(df) <- names(df) %>%
        tolower() %>%
        str_replace_all("s/he", " ") %>%
        str_replace_all("\\.x|\\.y", "") %>%
        str_replace_all("this |the |of |is |your |there ", " ") %>%
        str_replace_all("comsumption", "consumption") %>%
        str_replace_all("nennbers", "members") %>%
        str_replace_all("hans", "hands") %>%
        str_replace_all("decission", "decision") %>%
        str_replace_all("wrok", "work") %>%
        str_replace_all("slopping", "sloping") %>%
        str_replace_all("satiesfaction", "satisfaction") %>%
        str_replace_all("satiesfied", "satisfied") %>%
        str_replace_all("outside at home", "outside home") %>%
        str_replace_all("mutch", "much") %>%
        str_replace_all("you purchase from", " ") %>%
        str_replace_all("(kg)", " ") %>%
        str_replace_all("who makes decision for use", "decision") %>%
        str_replace_all("who makes decisions for spend", "decision") %>%
        str_replace_all("highly satisfied|moderately satisfied|not satisfied|dissatisfied", "satisfied") %>%
        str_replace_all("do you face any", " ") %>%
        str_replace_all("inpur", "input") %>%
        str_replace_all("input shop", " ") %>%
        str_replace_all("highly", " ") %>%
        str_replace_all("[:punct:]|=", " ") %>%
        str_replace_all("^[0-9 ]+", " ") %>%
        str_replace_all("what is ", " ") %>%
        str_replace_all("what name", "name") %>%
        str_replace_all("geo", "") %>%
        str_trim(side = "both") %>%
        str_replace_all("[ ]{2,}", " ") %>%
        str_replace_all(" ", "_") %>%
        str_replace_all("whomakesdecisionsforspendingmoney", "decision_money_you_earned")
    
        colnames(df)[str_detect(names(df), "deo")] <- "deo_id"
        colnames(df)[str_detect(names(df), "respondents_name")] <- "producer_name"
        colnames(df)[str_detect(names(df), "name_respondent")] <- "producer_name"
        colnames(df)[str_detect(names(df), "para_name")] <- "para"
        colnames(df)[str_detect(names(df), "village_name")] <- "village"
        colnames(df)[str_detect(names(df), "union_name")] <- "union"
        colnames(df)[str_detect(names(df), "thana_name")] <- "thana"
        colnames(df)[str_detect(names(df), "district_name")] <- "district"
        colnames(df)[str_detect(names(df), "group_name")] <- "group_name"
        colnames(df)[str_detect(names(df), "hh_type")] <- "household_type"
        colnames(df)[str_detect(names(df), "respondent_s_education")] <- "educational_status_respondent"
        colnames(df)[str_detect(names(df), "which_type_fodder")] <- "type_fodder_cultivating"

        colnames(df)[str_detect(names(df), "where_to_sale_milk")] <- "where_to_sell_milk"
        colnames(df)[str_detect(names(df), "what_are_drinking_water_sources_for_cattle")] <- "what_drinking_water_sources_for_cattle"
        colnames(df)[str_detect(names(df), 
                                "does_husband_help_you_in_day_to_day_household_activiti")] <- "does_husband_help_you_in_daily_household_work"
        colnames(df)[str_detect(names(df), 
                                "attended_group_meetings_within_village_do_you_have_to_take_p")] <- "attended_group_meetings_within_village_need_permission"
        colnames(df)[str_detect(names(df), 
                                "attend_meetings_at_a_distant_place_do_you_have_to_take_permissio")] <- "attend_meetings_at_a_distant_place_need_permission"
        colnames(df)[str_detect(names(df), 
                                "travel_to_distant_place_in_general_like_visit_to_relativeshse_do")] <- "travel_to_distant_place_do_you_have_to_take_permission"
        colnames(df)[str_detect(names(df), 
                                "travel_to_distant_place_in_general_like_visit_to_relativeshse_if")] <- "travel_distant_place_if_yes_from_whom"
        colnames(df)[str_detect(names(df), 
                                "if_yes_from_home")] <- "travel_distant_place_if_yes_from_whom"
        colnames(df)[str_detect(names(df), 
                                "where_did_yu_get_money_to_finance_dairy_activities")] <- "how_did_you_bear_dairy_related_expenses"
        colnames(df)[str_detect(names(df), 
                                "loan_source")] <- "loan_source"
        colnames(df)[str_detect(names(df), 
                                "if_receive_any_loans_during_how_much")] <- "if_receive_any_loan_how_much_was_it_tk"
        colnames(df)[str_detect(names(df), 
                                "do_you_haveany_plan_to_get_a_loan")] <- "if_not_have_you_any_plans_to_receive_a_loan"
        colnames(df)[str_detect(names(df), 
                                "if_yes_from_where_will_you_get_it")] <- "where_will_you_get_loan"
        colnames(df)[str_detect(names(df), 
                                "if_you_have_plans_to_get_a_loan_where_will_you_get_if_from")] <- "where_will_you_get_loan"
        colnames(df)[str_detect(names(df), 
                                "did_you_earned_any_income_during_last_6_months")] <- "have_you_earned_any_income_during_last_6_months"
        colnames(df)[str_detect(names(df), 
                                "if_yes_what_was_income_in_last_6_months")] <- "income_from_own_cattle_taka"
        colnames(df)[str_detect(names(df), 
                                "have_you_had_any_other_income_income_during_last_6_months")] <- "income_from_any_other_income_source_taka"
        colnames(df)[str_detect(names(df), 
                                "have_you_had_any_other_income_income_during_last_6_months")] <- "income_from_any_other_income_source_taka"


        
    df    
}
```

Let's apply this function on our data frames now.

```{r}
treatment_round2 <- treatment_round2 %>%
    make_names_consistent()
treatment_round3 <- treatment_round3 %>%
    make_names_consistent()
treatment_round4 <- treatment_round4 %>%
    make_names_consistent()
treatment_round5 <- treatment_round5 %>%
    make_names_consistent()
control_round5 <- control_round5 %>%
    make_names_consistent()

```

No we have to do some further cleaning up for more inconsistencies.

```{r}
all(names(treatment_round3) %in% names(treatment_round2))

## used code like this to find names that were different 
## but actually should be the same
#names(treatment_round4)[!names(treatment_round4) %in% names(treatment_round2)]
#names(treatment_round2)[!names(treatment_round2) %in% names(treatment_round4)]
```

Let's do some work on rounds 2, 3, and 4.

```{r}
treatment_round4[,c(60:100,302:311)] <- lapply(treatment_round4[,c(60:100,302:311)], as.numeric)
treatment_round2[,c(235:244,261:299)] <- lapply(treatment_round2[,c(235:244,261:299)], as.numeric)

process_names_more <- function(df) {
    df <- df %>%
        mutate(cow_rearing = rowSums(df[,grep("cow_rearing", colnames(df))], na.rm = TRUE),
               feed_practice = rowSums(df[,grep("feed_purchase", colnames(df))], na.rm = TRUE),
               from_where_vaccination_taken = rowSums(df[,grep("from_where_vaccination", colnames(df))], na.rm = TRUE),
               milking_cow = rowSums(df[,grep("milking_cow", colnames(df))], na.rm = TRUE),
               milk_selling = rowSums(df[,grep("milk_selling", colnames(df))], na.rm = TRUE),
               cattle_purchase = rowSums(df[,grep("cattle_purchase", colnames(df))], na.rm = TRUE),
               cattle_sales = rowSums(df[,grep("cattle_sales", colnames(df))], na.rm = TRUE),
               where_to_sell_milk = rowSums(df[,grep("where_to_sell_milk", colnames(df))], na.rm = TRUE),
               where_to_purchase_food = rowSums(df[,grep("where_to_purchase_feed", colnames(df))], na.rm = TRUE),
               decision_money = rowSums(df[,grep("decision_money", colnames(df))], na.rm = TRUE),
               decision_milk_sales_income = rowSums(df[,grep("decision_milk_sales_income", colnames(df))], na.rm = TRUE),
               knowledge_level = rowSums(df[,grep("knowledge_level", colnames(df))], na.rm = TRUE),
               skill_level = rowSums(df[,grep("skill_level", colnames(df))], na.rm = TRUE),
               service_vet_satisfied = rowSums(df[,grep("service_vet_doctor", colnames(df))], na.rm = TRUE), 
               dft_point_manager_satisfied = rowSums(df[,grep("dft_point_manager_milk_collector", colnames(df))], na.rm = TRUE),
               quality_products_ku = rowSums(df[,grep("quality_products_ku", colnames(df))], na.rm = TRUE),
               quality_service_ku = rowSums(df[,grep("quality_service_ku", colnames(df))], na.rm = TRUE)) %>%
        select(-hello_my_name_is,
               -cow_rearing_women_1,
               -cow_rearing_men_2,
               -cow_rearing_both_3,
               -feed_purchase_women_1,
               -feed_purchase_men_2,
               -feed_purchase_both_3,
               -milking_cow_women_1,
               -milking_cow_men_2,
               -milking_cow_both_3,
               -milk_selling_women_1,
               -milk_selling_men_2,
               -milk_selling_both_3,
               -cattle_purchase_wife_only_1,
               -cattle_purchase_husband_only_2,
               -cattle_purchase_jointly_3,
               -cattle_purchase_other_male_member_4,
               -cattle_purchase_other_female_member_5,
               -cattle_sales_wife_only_1,
               -cattle_sales_husband_only_2,
               -cattle_sales_jointly_3,
               -cattle_sales_other_male_member_4,
               -cattle_sales_other_female_member_5,
               -where_to_sell_milk_wife_only_1,
               -where_to_sell_milk_husband_only_2,
               -where_to_sell_milk_jointly_3,
               -where_to_sell_milk_other_male_member_4,
               -where_to_sell_milk_other_female_member_5,
               -where_to_purchase_feed_fooder_wife_only_1,
               -where_to_purchase_feed_fooder_husband_only_2,
               -where_to_purchase_feed_fooder_jointly_3,
               -where_to_purchase_feed_fooder_other_male_member_4,
               -where_to_purchase_feed_fooder_other_female_member_5,
               -from_where_vaccination_de_worming_wife_only_1,
               -from_where_vaccination_de_worming_husband_only_2,
               -from_where_vaccination_de_worming_jointly_3,
               -from_where_vaccination_de_worming_other_male_member_4,
               -from_where_vaccination_de_worming_other_female_member_5,
               -decision_milk_sales_income_self_1,
               -decision_milk_sales_income_husband_2,
               -decision_milk_sales_income_jointly_3,
               -decision_milk_sales_income_other_male_4,
               -decision_milk_sales_income_other_female_5,
               -decision_money_you_earned_self_1,
               -decision_money_you_earned_husband_2,
               -decision_money_you_earned_jointly_3,
               -decision_money_you_earned_other_male_member_4,
               -decision_money_you_earned_other_female_member_5,
               -knowledge_level_very_good_5,
               -knowledge_level_good_4,
               -knowledge_level_moderate_3,
               -knowledge_level_poor_2,
               -knowledge_level_un_satisfactory_1,
               -skill_level_very_good_5,
               -skill_level_good_4,
               -skill_level_moderate_3,
               -skill_level_poor_2,
               -skill_level_un_satisfactory_1,
               -service_vet_doctor_satisfied_4,
               -service_vet_doctor_satisfied_3,
               -service_vet_doctor_satisfied_2,
               -service_vet_doctor_satisfied_1,
               -dft_point_manager_milk_collector_satisfied_4,
               -dft_point_manager_milk_collector_satisfied_3,
               -dft_point_manager_milk_collector_satisfied_2,
               -dft_point_manager_milk_collector_satisfied_1,
               -quality_products_ku_4,
               -quality_products_ku_3,
               -quality_products_ku_2,
               -quality_products_ku_1,
               -quality_service_ku_4,
               -quality_service_ku_3,
               -quality_service_ku_2,
               -quality_service_ku_1)
    
    df
}


treatment_round2 <- treatment_round2 %>%
    process_names_more() %>%
    select(-service_vet_doctor_satisfied_5,
           -dft_point_manager_milk_collector_satisfied_5,
           -quality_products_ku_5,
           -quality_service_ku_5)

    
treatment_round3 <- treatment_round3 %>%
    process_names_more() %>%
    select(-service_vet_doctor_satisfied_5,
           -dft_point_manager_milk_collector_satisfied_5,
           -quality_products_ku_5,
           -quality_service_ku_5)


treatment_round4 <- treatment_round4 %>%
    process_names_more() %>%
    select(-text11) %>%
    mutate(vaccination = rowSums(treatment_round4[,grep("vaccination_de_worming_treatment_ai", 
                                                        colnames(treatment_round4))], na.rm = TRUE),
           others_satisfied = rowSums(treatment_round4[,grep("others_satisfied", 
                                                             colnames(treatment_round4))], na.rm = TRUE)) %>%
    select(-vaccination_de_worming_treatment_ai_cow_women_1,
           -vaccination_de_worming_treatment_ai_cow_men_2,
           -vaccination_de_worming_treatment_ai_cow_3,
           -others_satisfied_4,
           -others_satisfied_3,
           -others_satisfied_2,
           -others_satisfied_1)
```

Now let's work on round 5 a bit.

```{r}
colnames(treatment_round5)[74] <- "how_wash_hands"
colnames(treatment_round5)[76] <- "how_wash_milking_pot"
colnames(treatment_round5)[78] <- "how_wash_teat"
colnames(treatment_round5)[237] <- "cow_buy_if_yes_how_many"
colnames(treatment_round5)[241] <- "cow_sell_if_yes_how_many"
colnames(treatment_round5)[245] <- "calf_buy_if_yes_how_many"
colnames(treatment_round5)[269] <- "cow_died_if_yes_how_many"
colnames(treatment_round5)[128] <- "attended_group_meetings_within_village_if_yes_from_whom"
colnames(treatment_round5)[130] <- "attend_meetings_at_a_distant_place_if_yes_from_whom"
colnames(treatment_round5)[95] <- "total_score_knowledge"
colnames(treatment_round5)[101] <- "total_score_practice"

colnames(control_round5)[74] <- "how_wash_hands"
colnames(control_round5)[76] <- "how_wash_milking_pot"
colnames(control_round5)[78] <- "how_wash_teat"
colnames(control_round5)[95] <- "total_score_health"
colnames(control_round5)[101] <- "total_score_cowshed"
colnames(control_round5)[237] <- "cow_buy_if_yes_how_many"
colnames(control_round5)[241] <- "cow_sell_if_yes_how_many"
colnames(control_round5)[245] <- "calf_buy_if_yes_how_many"
colnames(control_round5)[269] <- "cow_died_if_yes_how_many"
colnames(control_round5)[128] <- "attended_group_meetings_within_village_if_yes_from_whom"
colnames(control_round5)[130] <- "attend_meetings_at_a_distant_place_if_yes_from_whom"


treatment_round5 <- treatment_round5 %>%
    select(-my_name_is,
           -sl_1, -sl_2, -sl_3,
           -calf_identification_2,
           -calf_identification_3,
           -breed_2, -breed_3,
           -selling_price_2, -selling_price_3,
           -selling_month_2, -selling_month_3,
           -sex_2, -sex_3) %>%
    rename(affected_by_disease_2 = affected_by_disease_yes_or_no_2,
           affected_by_disease_3 = affected_by_disease_what_did_you_do_3,
           affected_by_disease_4 = affected_by_disease_who_provide_treatment_4,
           affected_by_disease_5 = affected_by_disease_who_sugested_5,
           affected_by_disease_6 = affected_by_disease_fee_6,
           affected_by_disease_7 = affected_by_disease_diagnos_7,
           affected_by_disease_8 = affected_by_disease_medicine_8,
           vaccinated_2 = vaccinated_yes_or_no_2,
           vaccinated_4 = vaccinated_who_provide_treatment_4,
           vaccinated_5 = vaccinated_who_sugested_5,
           vaccinated_6 = vaccinated_fee_6,
           vaccinated_7 = vaccinated_diagnos_7,
           vaccinated_8 = vaccinated_vaccine_8,
           dewormed_2 = dewormed_yes_or_no_2,
           dewormed_4 = dewormed_who_provide_treatment_4,
           dewormed_5 = dewormed_who_sugested_5,
           dewormed_6 = dewormed_fee_6,
           dewormed_7 = dewormed_diagnos_7,
           dewormed_8 = dewormed_vaccine_8,
           dewormed_9 = dewormed_total_9,
           provided_ai_2 = provided_ai_yes_or_no_2,
           provided_ai_4 = provided_ai_who_provide_services_4,
           provided_ai_9 = provided_ai_total_9,
           provided_ni_2 = provided_ni_yes_or_no_2,
           provided_ni_4 = provided_ni_who_provide_services_4,
           provided_ni_9 = provided_ni_total_9,
           cow_buy_yes_no = did_you_purchase_any_cattle_last_6_months,
           cow_buy_type_cow = what_type_cattle_purchased,
           cow_buy_breed_cow = breed_type,
           cow_sell_yes_no = did_you_sell_any_cattle_last_6_months,
           cow_sell_type_cow = what_type_cattle,
           calf_sell_yes_no = did_you_sell_any_calf_last_6_months,
           calf_sell_type_cow = calf_identification_1,
           calf_sell_breed_cow = breed_1,
           calf_sell_calf_sex = sex_1,
           calf_sell_price_cow = selling_price_1,
           calf_sell_selling_month = selling_month_1,
           if_you_sell_cow_why_sold = if_yes_why_sold,
           did_you_have_any_calf_born_in_last_6_months = did_any_calf_born_last_6_months,
           how_many_calf_born = if_yes_how_many_cow_was_born,
           cow_died_yes_1_no_2 = did_any_cattle_die_during_last_6_months,
           cow_died_type_cow = type_death_cattle,
           cow_died_calf_sex = if_calf_sex,
           causes_death_cow = what_was_cause_death_cow,
           causes_death_calf = what_was_cause_death_calve)


control_round5 <- control_round5 %>%
    select(-my_name_is,
           -sl_1, -sl_2, -sl_3,
           -calf_identification_2,
           -calf_identification_3,
           -breed_2, -breed_3,
           -selling_price_2, -selling_price_3,
           -selling_month_2, -selling_month_3,
           -sex_2, -sex_3) %>%
    rename(affected_by_disease_2 = affected_by_disease_yes_or_no_2,
           affected_by_disease_3 = affected_by_disease_what_did_you_do_3,
           affected_by_disease_4 = affected_by_disease_who_provide_treatment_4,
           affected_by_disease_5 = affected_by_disease_who_sugested_5,
           affected_by_disease_6 = affected_by_disease_fee_6,
           affected_by_disease_7 = affected_by_disease_diagnos_7,
           affected_by_disease_8 = affected_by_disease_medicine_8,
           vaccinated_2 = vaccinated_yes_or_no_2,
           vaccinated_4 = vaccinated_who_provide_treatment_4,
           vaccinated_5 = vaccinated_who_sugested_5,
           vaccinated_6 = vaccinated_fee_6,
           vaccinated_7 = vaccinated_diagnos_7,
           vaccinated_8 = vaccinated_vaccine_8,
           dewormed_2 = dewormed_yes_or_no_2,
           dewormed_4 = dewormed_who_provide_treatment_4,
           dewormed_5 = dewormed_who_sugested_5,
           dewormed_6 = dewormed_fee_6,
           dewormed_7 = dewormed_diagnos_7,
           dewormed_8 = dewormed_vaccine_8,
           dewormed_9 = dewormed_total_9,
           provided_ai_2 = provided_ai_yes_or_no_2,
           provided_ai_4 = provided_ai_who_provide_services_4,
           provided_ai_9 = provided_ai_total_9,
           provided_ni_2 = provided_ni_yes_or_no_2,
           provided_ni_4 = provided_ni_who_provide_services_4,
           provided_ni_9 = provided_ni_total_9,
           cow_buy_yes_no = did_you_purchase_any_cattle_last_6_months,
           cow_buy_type_cow = what_type_cattle_purchased,
           cow_buy_breed_cow = breed_type,
           cow_sell_yes_no = did_you_sell_any_cattle_last_6_months,
           cow_sell_type_cow = what_type_cattle,
           calf_sell_yes_no = did_you_sell_any_calf_last_6_months,
           calf_sell_type_cow = calf_identification_1,
           calf_sell_breed_cow = breed_1,
           calf_sell_calf_sex = sex_1,
           calf_sell_price_cow = selling_price_1,
           calf_sell_selling_month = selling_month_1,
           if_you_sell_cow_why_sold = if_yes_why_sold,
           did_you_have_any_calf_born_in_last_6_months = did_any_calf_born_last_6_months,
           how_many_calf_born = if_yes_how_many_cow_was_born,
           cow_died_yes_1_no_2 = did_any_cattle_die_during_last_6_months,
           cow_died_type_cow = type_death_cattle,
           cow_died_calf_sex = if_calf_sex,
           causes_death_cow = what_was_cause_death_cow,
           causes_death_calf = what_was_cause_death_cattle)
```

How are things looking?

```{r}
length(names(treatment_round3)[!names(treatment_round3) %in% names(treatment_round2)])
length(names(treatment_round2)[!names(treatment_round2) %in% names(treatment_round3)])

length(names(treatment_round4)[!names(treatment_round4) %in% names(treatment_round2)])
length(names(treatment_round2)[!names(treatment_round2) %in% names(treatment_round4)])

length(names(treatment_round4)[!names(treatment_round4) %in% names(treatment_round5)])
length(names(treatment_round5)[!names(treatment_round5) %in% names(treatment_round4)])

length(names(treatment_round2)[!names(treatment_round2) %in% names(treatment_round5)])
length(names(treatment_round5)[!names(treatment_round5) %in% names(treatment_round2)])

length(names(control_round5)[!names(control_round5) %in% names(treatment_round5)])
length(names(treatment_round5)[!names(treatment_round5) %in% names(control_round5)])
```


## Getting Round 1 Ready

Round 1 is structured very, very differently than the rest of it, so we'll have to do this differently.

```{r}
treatment_round1_cows <- treatment_round1[,29:98]
treatment_round1 <- treatment_round1[,-c(29:98)]
treatment_round1 <- treatment_round1[,1:387]
#names(treatment_round1)
```

Let's get started.

```{r}
names(treatment_round1) <- names(treatment_round1) %>%
    tolower()

treatment_round1 <- treatment_round1 %>%
    rename(entry_id = entryid,
           household_number = `01baselinehouseholdnumber`,
           census_number = `02censusnoapplicableforcontrol2andcontrol3producer`,
           producer_name = `03anameoftherespondent`,
           sex_respondent = `03bsexfemale1male2other3`,
           name_household_head = `04nameofthehouseholdhead`,
           location = `05locationnearestlandmark`,
           para = `06para`,
           village = `07villagename`,
           union = `08unionname`,
           thana = `09thananame`,
           district = `10districtname`,
           household_type = `11hhtype`,
           interviewer_name = `12ainterviewername`,
           interview_id = `12binterviewerid`,
           supervisor_name = `13asupervisorname`,
           supervisor_id = `13bsupervisorid`,
           date_interview = `14dateofinterview`,
           age_respondent = ageofrespondent,
           no_of_family_members_total = nooffamilymembers,
           are_you_sdvc_group_member = areyousdvcgroupmember,
           group_code = groupcode,
           producer_id = membercode,
           group_name = whatisyourgroupname,
           position_in_group = positioningroup,
           total_consumption_ltr = milkconsumption,
           total_free_distribution_ltr = freedistribution,
           neighbors = salesneighbors,
           collection_point = salesdft,
           milk_collector = salescollector,
           open_market = salesopenmarket,
           sweetmeat_tea_stall = salesteastall,
           direct_to_company = salesdirecttocompant,
           yesterday_total_spoilage_ltr = spoilage,
           yesterday_total_income_from_milk_sale = totalrecieptfromsales,
           within_household_who_given_priority_to_consumed_milk = whowasgivenpriorityofyourfamilytoconsumemilkyesterday,
           why_was_given_priority_to_consumed_milk = whysshewasgivenprioritytoconsumemilk,
           who_consumed_milk_1 = whoconsumedmilkyesterday1,
           who_consumed_milk_2 = whoconsumedmilkyesterday2,
           who_consumed_milk_3 = whoconsumedmilkyesterday3,
           who_consumed_milk_4 = whoconsumedmilkyesterday4,
           are_you_cultivating_fodder = areyoucultivatingfodder,
           if_yes_cultivated_land_dec = ifyescultivatedlanddec,
           type_fodder_cultivating = whichtypeoffoddercultivating1,
           do_you_feed_green_grass_to_cow = doyoufedgreengrasstoyourcow,
           source_grass = sourceofgrass1,
           what_name_doctor_who_provides_cattle_treatment_to = whoprovidetreatmentservicetoyouranimal,
           what_type_vet_doctor_is = whichtypeofthedoctorsheis1,
           how_many_vaccines_should_be_given_for_cattle = howmanyvaccineshouldbegivenforcattle1,
           what_are_vaccines = whatarethose,
           which_vaccines_have_you_given_to_cattle = whichvaccines,
           have_you_dewormed_cattle_in_last_6_months = didyoudewormed,
           how_many_days_deworming = howmanydaysbefore,
           who_suggested_deworming = whosuggestedyou1,
           from_where_vaccination_taken = whodecideswhethervaccinationdewormingtreatmentaiisprovidedforcat,
           what_drinking_water_sources_for_cattle = whatarethedrinkingwatersourcesforyourcattle1,
           do_you_wash_cattle = doyouwashyourcattle,
           if_not_why = ifnowhy,
           if_you_wash_cattle_how_often = ifyesinwhichinterval,
           measurement_taken_for_bio_security = measurementtakenforbiosecurity1,
           cow_rearing = sexofthepersonwhoengagedwithcowrearing,
           feed_practice = sexofthepersonwhoengagedwithcattlefeedpurchase,
           milk_selling = sexofthepersonwhoengagedwithmilkselling,
           where_to_sell_milk = whodecideswheretosellmilk,
           cattle_purchase = whotakesthecattlepurchasedecision1,
           cattle_sales = whotakesthecattlesalesdecision1,
           where_to_purchase_food = whodecidesfromwheretopurchasefeedfodder1,
           milking_cow = whoengagedinmilkingthecow,
           if_you_do_not_engaged_in_milking_why_not = ifyoudonotengagedinmilkingwhynot,
           do_you_wash_hands_before_milking = doyouwashyourhandbeforeandaftermilking,
           how_wash_hands = ifyeshow,
           do_you_wash_milking_pot = doyouwashyourmilkingpot,
           how_wash_milking_pot = ifyeshow_a,
           do_you_wash_under_teat_before_milking = doyouwashudderandteatbeforemilking,
           how_wash_teat = how,
           do_you_use_anything_on_under_teat_during_milking = doyouuseanythingontheudderandteatduringmilking,
           if_yes_what = ifyeswhat1,
           where_do_you_dispose_cowdung = wheredoyoudisposecowdung1,
           what_do_you_do_with_cowdung = whatdoyoudowithcowdung1,
           what_types_cattle_feeds_are_there = whattypesofcattlefeedsare,
           which_type_feed_increase_milk_fat = whichtypeoffeedincreasethemilkfat,
           mention_name_a_few_hybrid_fodders = mentionthenameoffewhybridfodder,
           mention_name_few_concentrated_feeds = mentionthenameoffewconcentratefeed,
           what_should_be_condition_cow_shed = whatshouldbetheconditionofcowshed,
           which_type_cattle_should_get_vaccinated = whichtypeofcattleshouldvaccinate,
           what_are_symptoms_worm_affected_cattle = whatarethesymptomsofwormaffectedcattle,
           in_which_interval_should_de_worming_should_be_done = inwhichintervaldewormingshouldbedone,
           how_long_after_heat_detection_best_time_for_ai = afterheatdetectionwhichisthebesttimeforai,
           what_are_advantages_ai = whataretheadvantagesofai,
           total_score_knowledge = totalknowledgescore,
           proper_ventilation_system_available_in_cow_shed = properventilationsystemisavailableincowshedornot,
           cleanliness_floor_cow_shed = cleanlinessofthefloorofcowshed,
           proper_sloping_floor_to_drain = isthereanypropersloppingofthefloortothedrainornot,
           a_disposal_place_for_cow_dung = isthereanydisposalplaceforcowdungornot,
           cleanliness_milking_place = cleanlinessofthemilkingplace,
           total_score_practice = totalpracticescore,
           do_you_own_any_cattle = doyouownedanycattle,
           did_you_get_ownership_cow_after_joining_sdvc = didyougetownershipofcowafterjoiningsdvc,
           how_did_you_get_ownership_cow = didyouinheritanycattlecowfromfatherhusbandothers1,
           decision_money = whotakedecisionforuseyourownincome1,
           decision_milk_sales_income = whotakedecisionforusethemilksalesincome1,
           have_any_asset_been_purchased_with_money_you_have_earned = haveanyassetsbeenpurchasedwithmoneyyouhaveearnedduringlastmonths,
           asset_1_name_asset = asset1name,
           asset_1_who_made_decision_to_buy_assets = asset1whomadedecisiontobuythisassets1,
           asset_1_who_control_asset = asset1whocontrolthisasset1,
           asset_2_name_asset = asset2name,
           asset_2_who_made_decision_to_buy_assets = asset2whomadedecisiontobuythisassets,
           asset_2_who_control_asset = asset2whocontrolthisasset,
           asset_3_name_asset = asset3name,
           asset_3_who_made_decision_to_buy_asset = asset3whomadedecisiontobuythisassets,
           asset_3_who_control_asset = asset3whocontrolthisasset,
           asset_4_name_asset = asset4name,
           asset_4_who_made_decision_to_buy_asset = asset4whomadedecisiontobuythisassets,
           asset_4_who_control_asset = asset4whocontrolthisasset,
           asset_5_name_asset = asset5name,
           asset_5_who_made_decision_to_buy_asset = asset5whomadedecisiontobuythisassets,
           asset_5_who_control_asset = asset5whocontrolthisasset,
           attended_group_meetings_within_village_need_permission = doyouhavetotakepermissiontoattendedgroupmeeting,
           attended_group_meetings_within_village_if_yes_from_whom = ifyesfromwhom1,
           attend_meetings_at_a_distant_place_need_permission = doyouhavetotakepermissiontoattendedmeetingatdistantplace,
           attend_meetings_at_a_distant_place_if_yes_from_whom = ifyesfromwhom1_a,
           travel_to_distant_place_do_you_have_to_take_permission = doyouhavetotakepermissiontotravelatadistantplaceingeneralliketov,
           travel_distant_place_if_yes_from_whom = ifyesfromwhom1_b,
           does_husband_help_you_in_daily_household_work = doyourhusbandhelpyouinyourdaytodayhhactivities,
           cattle_feeding = cattlefeeding,
           cattle_wash = cattlewash,
           grass_collection = grasscollection,
           child_teaching = childteaching,
           feed_children = feedthechildren,
           home_arrangement = homearrangement,
           house_clearing = housecleaning,
           others_specify = others,
           obstruction_from_family_for_own_income = doyoufaceanyobstructionfromyourfamily,
           asset_purchase_own = assetpurchaseofyourown1,
           income_generating_activities_at_home = incomegeneratingactivitiesathome1,
           income_generating_activities_outside_home = incomegeneratingactivitiesoutsideofhome1,
           own_asset_sales = ownassetsales1,
           spend_own_asset = spendownincome1,
           attend_meeting_training_at_distant_place = attendmeetingtrainingatdistantplace1,
           amount_rice_bran = ricebran_amount,
           unit_rice_bran = ricebran_unit,
           source_rice_bran = ricebran_source1,
           taka_rice_bran = ricebran_taka,
           amount_wheat_bran = wheatbran_amount,
           unit_wheat_bran = wheatbran_unit,
           source_wheat_bran = wheatbran_source,
           taka_wheat_bran = wheatbran_taka,
           amount_pulse_husk = pulsehusk_amount,
           unit_pulse_husk = pulsehusk_unit,
           source_pulse_husk = pulsehusk_source,
           taka_pulse_husk = pulsehusk_taka,
           amount_broken_rice = brokenrice_amount,
           unit_broken_rice = brokenrice_unit,
           source_broken_rice = brokenrice_source1,
           taka_broken_rice = brokenrice_taka,
           amount_molasess = molasses_amount,
           unit_molasess = molasses_unit,
           source_molasess = molasses_source,
           taka_molasess = molasses_taka,
           amount_broken_maize = brokenmaize_amount,
           unit_broken_maize = brokenmaize_unit,
           source_broken_maize = brokenmaize_source,
           taka_broken_maize = brokenmaize_taka,
           amount_coconut_oil_cake = coconutoilcake_amount,
           unit_coconut_oil_cake = coconutoilcake_unit,
           source_coconut_oil_cake = coconutoilcake_source,
           taka_coconut_oil_cake = coconutoilcake_taka,
           amount_mustard_oil_cake = mustardoilcake_amount,
           unit_mustard_oil_cake = mustardoilcake_unit,
           source_mustard_oil_cake = mustardoilcake_source1,
           taka_mustard_oil_cake = mustardoilcake_taka,
           amount_mineral_mix = mineralmix_amount,
           unit_mineral_mix = mineralmix_unit,
           source_mineral_mix = mineralmix_source,
           taka_mineral_mix = mineralmix_taka,
           amount_dcp = dcp_amount,
           unit_dcp = dcp_unit,
           source_dcp = dcp_source,
           taka_dcp = dcp_taka,
           amount_straw = straw_amount,
           unit_straw = straw_unit,
           source_straw = straw_source1,
           taka_straw = straw_taka,
           amount_green_grass = greengrass_amount,
           unit_green_grass = greengrass_unit,
           source_green_grass = greengrass_source1,
           taka_green_grass = greengrass_taka,
           amount_ready_feed = readyfeed_amount,
           unit_ready_feed = readyfeed_unit,
           source_ready_feed = readyfeed_source1,
           taka_ready_feed = readyfeed_taka,
           amount_total = total_amount,
           taka_total = total_taka,
           affected_by_disease_2 = affectedbydiseaseyesno,
           affected_by_disease_3 = actiontakenaffectedbydisease,
           affected_by_disease_4 = whoprovidedtreatment1,
           affected_by_disease_6 = treatmentfees,
           affected_by_disease_7 = diagnosiscost,
           affected_by_disease_8 = medicinecost,
           affected_by_disease_9 = totaltreatmentcost,
           vaccinated_2 = vaccinatedyesno,
           vaccinated_4 = whoprovidedvaccinne1,
           vaccinated_6 = feeforvaccination,
           vaccinated_7 = diagnosiscostforvaccination,
           vaccinated_8 = vaccinecost,
           vaccinated_9 = totalvaccinationcost,
           dewormed_2 = dewormedyesno,
           dewormed_4 = provideddewormed1,
           dewormed_9 = totaldewormingcost,
           provided_ai_2 = providedaiyesno,
           provided_ai_4 = whoprovidedai1,
           provided_ai_9 = totalaicost,
           provided_ni_2 = providedniyesno,
           provided_ni_4 = niprovidersource,
           provided_ni_9 = totalnicost,
           total_expenditure = totalcost,
           cow_buy_yes_no = didyoupurchaseanycattle,
           cow_buy_if_yes_how_many = howmanycattlepurchase,
           cow_buy_type_cow = typeofcattlepurchased1,
           cow_buy_breed_cow = breedtypeofpurchasedcattle,
           cow_sell_yes_no = didyousaleanycattle,
           cow_sell_if_yes_how_many = howmanycattlesold,
           cow_sell_type_cow = typeofcattlesold1,
           if_you_sell_cow_why_sold = whysoldthem1,
           calf_sell_yes_no = didyousellanycalf,
           calf_sell_how_many = howmanycalfsold,
           calf_sell_price_cow = calf1price,
           calf_sell_calf_sex = calf1sex,
           calf_sell_selling_month = calf1soldmonth,
           total_selling_price = totalcalfsaleincome,
           did_you_have_any_calf_born_in_last_6_months = didyouhaveanycalfborninthelast6months,
           how_long_was_dry_period = howlongwasthedryperiod,
           cow_died_yes_1_no_2 = diedanycattle,
           cow_died_if_yes_how_many = yeshowmany,
           cow_died_type_cow = typeofdeadcattle1,
           what_did_you_do_with_dead_cattle = whatdidyoudowithdeadcattle1,
           how_did_you_bear_dairy_related_expenses = wheredidyougetthemoneytofinanceyourdairy1,
           if_receive_any_loan_how_much_was_it_tk = ifreceiveanyloanshowmuch,
           loan_source = loansource1,
           if_not_have_you_any_plans_to_receive_a_loan = ifnottakenloanhaveanyplantoreceiveloan,
           where_will_you_get_loan = ifhaveplanfromwheretoreceiveloan1,
           how_many_times_has_vet_doctor_visited_farm_thelast_3 = howmanytimesthevetdoctorvisitedyourfarm,
           knowledge_level = knowledgelevelofthatvetdoctor,
           skill_level = skilllevelofthatvetdoctor,
           responsivness_that_vet_doctor_when_called = responsivenessofthatvetdoctorwhencall,
           range_fee_received = rangeoffeereceived,
           does_vet_doctor_provides_prescription = doesheprovideprescription,
           service_vet_satisfied = areyousatisfiedwiththeserviceofvetdoctor,
           where_do_you_sell_milk_in_general = wheredoyousellmilk1,
           why_do_you_chose_to_sell_milk_here = whydoyouchoosetosellmilkhere,
           are_you_satisfied_with_overall_services_dft = levelofsatisfactionwithdftpointormilkcollector,
           are_you_satisfied_with_methods_measurement_milk = areyousatisfiedwiththemethodsofmeasurement,
           explain = describewhy,
           do_you_think_milk_transactions_are_fair = doyouthinkthemilksalestransactionsarefair,
           explains = describewhy_a,
           where_do_you_purchase_inputs = wheredoyoupurchaseyourinputs1,
           have_you_recently_changed_where_you_purchase_inputs = haveyourecentlychangedwhereyoupurchaseyourinputs,
           where_did_you_previously_purchase_inputs = wheredidyoupreviouslypurchaseyourinputs1,
           quality_products_ku = howwouldyouratethequalityoftheproductsyoupurchasethere,
           quality_service_ku = howwouldyouratethequalityoftheserviceyoupurchasethere,
           what_type_effective_action_taken_by_fls_for_group_development = whattypeeffectiveactiontakenbyflsforgroupdevelopment,
           how_are_decision_taken_in_group = howthedecisionsaretakeninthegroup1,
           level_satisfaction_fls_activities = levelofsatisfactionofflsactivities) %>%
    mutate(how_often_have_you_gone_to_ku_during_last_3_month = 0.5 * as.numeric(howoftendidyougototheinputkushopinthepast6months),
           income_from_cowdung_sold_during_last_6_months = 2 * as.numeric(incomefromcowdungsoldduringlast3months),
           income_from_own_cattle_taka = 2 * as.numeric(haveanyincomefromthosecattleduringlast3months),
           income_from_any_other_income_source_taka = 2 * as.numeric(doyouhaveanyotherincomeduringlast3months) )
```

Now let's remove a whole bunch of columns we don't need anymore.

```{r}
treatment_round1 <- treatment_round1 %>%    
    select(-whoconsumedmilkyesterday5,
           -whichtypeoffoddercultivating2,
           -whichtypeoffoddercultivating3,
           -whichtypeoffoddercultivating4,
           -sourceofgrass2,
           -sourceofgrass3,
           -whichtypeofthedoctorsheis2,
           -whichtypeofthedoctorsheis3,
           -howmanyvaccineshouldbegivenforcattle2,
           -whosuggestedyou2,
           -whotakesthecattlepurchasedecision2,
           -whodecideswhethervaccinationdewormingtreatmentaiisprovidedforc_a,
           -whatarethedrinkingwatersourcesforyourcattle2,
           -measurementtakenforbiosecurity2,
           -measurementtakenforbiosecurity3,
           -whatarethereasonsforthesechanges,
           -whotakesthecattlesalesdecision2,
           -whodecidesfromwheretopurchasefeedfodder2,
           -ifyeswhatarethey,
           -ifyeswhat2,
           -explainyourcomments,
           -wheredoyoudisposecowdung2,
           -wheredoyoudisposecowdung3,
           -whatdoyoudowithcowdung2,
           -whatdoyoudowithcowdung3,
           -whatdoyoudowithcowdung4,
           -whatdoyoudowithcowdung5,
           -didyouinheritanycattlecowfromfatherhusbandothers2,
           -whotakedecisionforuseyourownincome2,
           -whotakedecisionforusethemilksalesincome2,
           -ifyesputinformationinthefollowingtable,
           -ifyesinwhichcaseobstaclesapplier,
           -incomegeneratingactivitiesathome2,
           -incomegeneratingactivitiesathome3,
           -incomegeneratingactivitiesoutsideofhome2,
           -incomegeneratingactivitiesoutsideofhome3,
           -ownassetsales2,
           -ownassetsales3,
           -ifyesfromwhom2,
           -ifyesfromwhom3,
           -ifyesfromwhom2_a,
           -ifyesfromwhom2_b,
           -ifyesfromwhom3_a,
           -ifyesfromwhom3_b,
           -washchildern,
           -assetpurchaseofyourown2,
           -assetpurchaseofyourown3,
           -loansource2,
           -loansource3,
           -loansource4,
           -ifhaveplanfromwheretoreceiveloan2,
           -ifhaveplanfromwheretoreceiveloan3,
           -ifhaveplanfromwheretoreceiveloan4,
           -didyouobserveanychangeindairyrelatedactivities,
           -isthereanyorganizationgovtinstituteworkingherefordairydevelopme,
           -ifyeswhatactivitiesaretheyarecontinuingfordairydevelopment,
           -whatistheroleoffarmerleaderflforgroupdevelopment,
           -mainlywhoisresponsibleforsellingthemilk1,
           -mainlywhoisresponsibleforsellingthemilk2,
           -mainlywhoreceivespaymentfrommilksales1,
           -describehowyoudecidedwhowillreceivepaymentinhh,
           -wheredidyoupreviouslypurchaseyourinputs2,
           -wheredidyoupreviouslypurchaseyourinputs3,
           -mainlywhoreceivespaymentfrommilksales2,
           -whatisthenameofvetdoctorserveinyourgroup,
           -howoftendidyougototheinputkushopinthepast6months,
           -incomefromcowdungsoldduringlast3months,
           -haveanyincomefromthosecattleduringlast3months,
           -doyouhaveanyotherincomeduringlast3months,
           -overallcommentsifany,
           -whatdoyouthinkdftcontributingtoincreasingdecreasingyourgroupcohe,
           -spendownincome2,
           -attendmeetingtrainingatdistantplace2,
           -ricebran_source2,
           -brokenrice_source2,
           -mustardoilcake_source2,
           -straw_source2,
           -straw_source3,
           -greengrass_source2,
           -greengrass_source3,
           -readyfeed_source2,
           -typeofcattlepurchased2,
           -typeofcattlepurchased3,
           -typeofcattlesold2,
           -typeofcattlesold3,
           -typeofcattlesold4,
           -typeofcattlesold5,
           -typeofcattlesold6,
           -ccalf1calfid, -ccalf2calfid, -ccalf3calfid,
           -calf1breed, -calf2breed, -calf3breed,
           -calf2sex, -calf2price, -calf3sex, -calf3price,
           -calf2soldmonth, -calf3soldmonth,
           -typeofdeadcattle2,
           -whatdidyoudowithdeadcattle2,
           -wheredidyougetthemoneytofinanceyourdairy2,
           -wheredidyougetthemoneytofinanceyourdairy3,
           -howthedecisionsaretakeninthegroup2,
           -wheredoyoupurchaseyourinputs2,
           -wheredoyoupurchaseyourinputs3,
           -wheredoyousellmilk2,
           -whattypeofthevetdoctoris1,
           -whattypeofthevetdoctoris2,
           -whattypeofthevetdoctoris3,
           -whoprovidedtreatment2,
           -whoprovidedtreatment3,
           -asset1whomadedecisiontobuythisassets2,
           -asset1whocontrolthisasset2,
           -whysoldthem2,
           -whoprovidedvaccinne2,
           -provideddewormed2,
           -whoprovidedai2)

length(names(treatment_round1)[!names(treatment_round1) %in% names(treatment_round2)])
length(names(treatment_round1)[!names(treatment_round1) %in% names(treatment_round5)])


```



## Calculating Cattle Information

For each producer, we need to know

- total number of cows per breed per producer
- average and median value of cows per breed per producer

Let's work on this, by writing a function to do the operations to find these quantities.

```{r}
library(tidyr)

calculate_cows <- function(df) {
    cow_df <- df %>% 
        group_by(deo_id, breed_of_cow) %>% 
        summarise(number = n(),
                  mean_bdt = mean(`Value of Cow in BDT`, na.rm = TRUE),
                  median_bdt = median(`Value of Cow in BDT`, na.rm = TRUE)) %>%
        rename(number_breed = breed_of_cow) %>%
        mutate(mean_value = number_breed,
               median_value = number_breed) %>%
        spread(number_breed, number, sep = "_") %>%
        spread(mean_value, mean_bdt, sep = "_") %>%
        spread(median_value, median_bdt, sep = "_") %>%
        select(-number_breed_NA, -mean_value_NA, -median_value_NA) %>%
        ungroup
    
    ret <- cow_df %>%
        group_by(deo_id) %>%
        summarise(number_cattle_breed_1 = max(number_breed_1, na.rm = TRUE),
                  number_cattle_breed_2 = max(number_breed_2, na.rm = TRUE),
                  mean_value_cattle_breed_1 = max(mean_value_1, na.rm = TRUE),
                  mean_value_cattle_breed_2 = max(mean_value_2, na.rm = TRUE),
                  median_value_cattle_breed_1 = max(median_value_1, na.rm = TRUE),
                  median_value_cattle_breed_2 = max(median_value_2, na.rm = TRUE))
}
```




```{r}
calculate_cows_round5 <- control_round5_cows %>%
    rename(deo_id = `DEO ID`,
           breed_of_cow = `Bread of Cow`) %>%
    calculate_cows
control_round5 <- control_round5 %>% 
    left_join(calculate_cows_round5, by = "deo_id")
```






## Merging All Rounds

Now let's merge these together. First let's convert everything to character type.

```{r}
treatment_round1[] <- lapply(treatment_round1, as.character)
treatment_round2[] <- lapply(treatment_round2, as.character)
treatment_round3[] <- lapply(treatment_round3, as.character)
treatment_round4[] <- lapply(treatment_round4, as.character)
treatment_round5[] <- lapply(treatment_round5, as.character)
control_round5[] <- lapply(control_round5, as.character)
```

Now let's merge!

```{r}
gpf_merged <- bind_rows(treatment_round1 %>% mutate(round = 1),
                        treatment_round2 %>% mutate(round = 2),
                        treatment_round3 %>% mutate(round = 3),
                        treatment_round4 %>% mutate(round = 4),
                        treatment_round5 %>% mutate(round = 5),
                        control_round5 %>% mutate(round = 5)) %>%
    select(round, everything())

```

How big did this end up?

```{r}
dim(gpf_merged)
```

There are a few things that we need to fix from some `NA` handling up above.

```{r}
gpf_merged$cow_rearing[gpf_merged$cow_rearing == 0] <- NA
gpf_merged$feed_practice[gpf_merged$feed_practice == 0] <- NA
gpf_merged$from_where_vaccination_taken[gpf_merged$from_where_vaccination_taken == 0] <- NA
gpf_merged$milking_cow[gpf_merged$milking_cow == 0] <- NA
gpf_merged$milk_selling[gpf_merged$milk_selling == 0] <- NA
gpf_merged$cattle_purchase[gpf_merged$cattle_purchase == 0] <- NA
gpf_merged$cattle_sales[gpf_merged$cattle_sales == 0] <- NA
gpf_merged$where_to_sell_milk[gpf_merged$where_to_sell_milk == 0] <- NA
gpf_merged$where_to_purchase_food[gpf_merged$where_to_purchase_food == 0] <- NA
gpf_merged$decision_money[gpf_merged$decision_money == 0] <- NA
gpf_merged$decision_milk_sales_income[gpf_merged$decision_milk_sales_income == 0] <- NA
gpf_merged$knowledge_level[gpf_merged$knowledge_level == 0] <- NA
gpf_merged$skill_level[gpf_merged$skill_level == 0] <- NA
gpf_merged$service_vet_satisfied[gpf_merged$service_vet_satisfied == 0] <- NA
gpf_merged$dft_point_manager_satisfied[gpf_merged$dft_point_manager_satisfied == 0] <- NA
gpf_merged$quality_products_ku[gpf_merged$quality_products_ku == 0] <- NA
gpf_merged$quality_service_ku[gpf_merged$quality_service_ku == 0] <- NA
gpf_merged$others_satisfied[gpf_merged$others_satisfied == 0] <- NA
gpf_merged$vaccination[gpf_merged$vaccination == 0] <- NA

```

Now let's write this file to a csv.

```{r}
library(readr)
write_csv(gpf_merged, "../data/gpf_merged.csv")
```

Let's also save the original names as a csv to be able to look at.

```{r}
library(tidyr)
write_csv(original_names %>% unnest(names), "../data/gpf_original_names.csv")
```

                    